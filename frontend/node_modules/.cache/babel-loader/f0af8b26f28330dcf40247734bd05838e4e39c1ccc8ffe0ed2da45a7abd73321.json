{"ast":null,"code":"import _objectSpread from\"/home/ubuntu/application/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{Typography,Button,Box,CircularProgress,ButtonGroup}from'@mui/material';import{useNavigate,useParams}from'react-router-dom';import{useAuth}from'../contexts/AuthContext';import axios from'../utils/axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function RegistrationList(){const navigate=useNavigate();const{id}=useParams();const{user}=useAuth();const[loading,setLoading]=useState(true);const[registrations,setRegistrations]=useState([]);const[error,setError]=useState(null);useEffect(()=>{const fetchRegistrations=async()=>{setLoading(true);try{const response=await axios.get(\"/api/registrations/camp/\".concat(id));const data=response.data||[];console.log('Fetched registrations:',data);// Ensure each registration has the required properties\nconst processedData=data.map(reg=>_objectSpread(_objectSpread({},reg),{},{registration_id:reg.registration_id||reg.id,// Fallback to id if registration_id is not present\nopd_number:reg.opd_number||\"OPD-\".concat(reg.registration_id||reg.id)}));setRegistrations(processedData);}catch(error){console.error('Failed to fetch registrations:',error);}finally{setLoading(false);}};fetchRegistrations();},[id]);const handleViewDetails=registrationId=>{if(!registrationId){console.error('No registration ID provided');return;}// Navigate to patient details view\nconsole.log('Navigating to patient details:',registrationId);navigate(\"/registration/\".concat(registrationId),{state:{fromList:true}});};const handleOpenExam=registrationId=>{if(!registrationId){console.error('No registration ID provided');return;}// Navigate to doctor examination view\nnavigate(\"/registrations/\".concat(registrationId,\"/exam\"));};const handleDelete=async registrationId=>{if(!registrationId){console.error('No registration ID provided for deletion');return;}if(window.confirm('Are you sure you want to delete this registration? This action cannot be undone.')){try{await axios.delete(\"/api/registrations/\".concat(registrationId));// Refresh the list after deletion\nconst response=await axios.get(\"/api/registrations/camp/\".concat(id));const data=response.data||[];const processedData=data.map(reg=>_objectSpread(_objectSpread({},reg),{},{registration_id:reg.registration_id||reg.id,opd_number:reg.opd_number||\"OPD-\".concat(reg.registration_id||reg.id)}));setRegistrations(processedData);alert('Registration deleted successfully');}catch(error){console.error('Failed to delete registration:',error);alert('Failed to delete registration. Please try again.');}}};const handleNewRegistration=()=>{navigate(\"/camps/\".concat(id,\"/register\"));};const handleExportCsv=()=>{// TODO: Implement CSV export\n};if(loading){return/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'center',alignItems:'center',minHeight:'60vh'},children:/*#__PURE__*/_jsx(CircularProgress,{})});}return/*#__PURE__*/_jsxs(Box,{sx:{p:3},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",sx:{mb:2},children:[\"Registrations for Camp #\",id]}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'flex-end',gap:2,mb:3},children:[/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",onClick:handleNewRegistration,children:\"NEW REGISTRATION\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:handleExportCsv,children:\"EXPORT TO CSV\"})]}),registrations.map(registration=>/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'space-between',alignItems:'flex-start',p:2,borderBottom:'1px solid #eee','&:hover':{backgroundColor:'#f5f5f5'}},children:/*#__PURE__*/_jsxs(Box,{sx:{flex:1},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',alignItems:'center',mb:0.5},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"body1\",children:[registration.opd_number||\"OPD-\".concat(registration.registration_id),\" \\u2014 \",registration.first_name,\" \",registration.last_name]}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',gap:1},children:[/*#__PURE__*/_jsx(Button,{variant:\"contained\",size:\"small\",color:\"error\",onClick:()=>handleDelete(registration.registration_id),sx:{minWidth:'80px'},children:\"Delete\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",size:\"small\",color:\"primary\",onClick:()=>handleViewDetails(registration.registration_id),sx:{minWidth:'80px'},children:\"View\"})]})]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"text.secondary\",children:[\"Guardian: \",registration.guardian_name,\" | Age: \",registration.age,\" | Mobile: \",registration.mobile,\" | Aadhar: \",registration.aadhar]})]})},registration.registration_id)),registrations.length===0&&/*#__PURE__*/_jsx(Typography,{variant:\"body1\",align:\"center\",sx:{py:3},children:\"No registrations found\"})]});}export default RegistrationList;","map":{"version":3,"names":["React","useState","useEffect","Typography","Button","Box","CircularProgress","ButtonGroup","useNavigate","useParams","useAuth","axios","jsx","_jsx","jsxs","_jsxs","RegistrationList","navigate","id","user","loading","setLoading","registrations","setRegistrations","error","setError","fetchRegistrations","response","get","concat","data","console","log","processedData","map","reg","_objectSpread","registration_id","opd_number","handleViewDetails","registrationId","state","fromList","handleOpenExam","handleDelete","window","confirm","delete","alert","handleNewRegistration","handleExportCsv","sx","display","justifyContent","alignItems","minHeight","children","p","variant","mb","gap","color","onClick","registration","borderBottom","backgroundColor","flex","first_name","last_name","size","minWidth","guardian_name","age","mobile","aadhar","length","align","py"],"sources":["/home/ubuntu/application/frontend/src/pages/RegistrationList.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { \n  Typography,\n  Button,\n  Box,\n  CircularProgress,\n  ButtonGroup,\n} from '@mui/material';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { useAuth } from '../contexts/AuthContext';\nimport axios from '../utils/axios';\n\nfunction RegistrationList() {\n  const navigate = useNavigate();\n  const { id } = useParams();\n  const { user } = useAuth();\n  const [loading, setLoading] = useState(true);\n  const [registrations, setRegistrations] = useState([]);\n  const [error, setError] = useState(null);\n\n    useEffect(() => {\n    const fetchRegistrations = async () => {\n      setLoading(true);\n      try {\n        const response = await axios.get(`/api/registrations/camp/${id}`);\n        const data = response.data || [];\n        console.log('Fetched registrations:', data);\n        \n        // Ensure each registration has the required properties\n        const processedData = data.map(reg => ({\n          ...reg,\n          registration_id: reg.registration_id || reg.id, // Fallback to id if registration_id is not present\n          opd_number: reg.opd_number || `OPD-${reg.registration_id || reg.id}`\n        }));\n        \n        setRegistrations(processedData);\n      } catch (error) {\n        console.error('Failed to fetch registrations:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchRegistrations();\n  }, [id]);\n\n  const handleViewDetails = (registrationId) => {\n    if (!registrationId) {\n      console.error('No registration ID provided');\n      return;\n    }\n    // Navigate to patient details view\n    console.log('Navigating to patient details:', registrationId);\n    navigate(`/registration/${registrationId}`, { state: { fromList: true } });\n  };\n\n  const handleOpenExam = (registrationId) => {\n    if (!registrationId) {\n      console.error('No registration ID provided');\n      return;\n    }\n    // Navigate to doctor examination view\n    navigate(`/registrations/${registrationId}/exam`);\n  };\n\n  const handleDelete = async (registrationId) => {\n    if (!registrationId) {\n      console.error('No registration ID provided for deletion');\n      return;\n    }\n\n    if (window.confirm('Are you sure you want to delete this registration? This action cannot be undone.')) {\n      try {\n        await axios.delete(`/api/registrations/${registrationId}`);\n        // Refresh the list after deletion\n        const response = await axios.get(`/api/registrations/camp/${id}`);\n        const data = response.data || [];\n        const processedData = data.map(reg => ({\n          ...reg,\n          registration_id: reg.registration_id || reg.id,\n          opd_number: reg.opd_number || `OPD-${reg.registration_id || reg.id}`\n        }));\n        setRegistrations(processedData);\n        alert('Registration deleted successfully');\n      } catch (error) {\n        console.error('Failed to delete registration:', error);\n        alert('Failed to delete registration. Please try again.');\n      }\n    }\n  };\n\n  const handleNewRegistration = () => {\n    navigate(`/camps/${id}/register`);\n  };\n\n  const handleExportCsv = () => {\n    // TODO: Implement CSV export\n  };\n\n  if (loading) {\n    return (\n      <Box sx={{ display: 'flex', justifyContent: 'center', alignItems: 'center', minHeight: '60vh' }}>\n        <CircularProgress />\n      </Box>\n    );\n  }\n\n  return (\n    <Box sx={{ p: 3 }}>\n      <Typography variant=\"h6\" sx={{ mb: 2 }}>Registrations for Camp #{id}</Typography>\n      \n      <Box sx={{ display: 'flex', justifyContent: 'flex-end', gap: 2, mb: 3 }}>\n        <Button \n          variant=\"contained\" \n          color=\"primary\"\n          onClick={handleNewRegistration}\n        >\n          NEW REGISTRATION\n        </Button>\n        <Button \n          variant=\"outlined\"\n          onClick={handleExportCsv}\n        >\n          EXPORT TO CSV\n        </Button>\n      </Box>\n\n      {registrations.map((registration) => (\n        <Box\n          key={registration.registration_id}\n          sx={{\n            display: 'flex',\n            justifyContent: 'space-between',\n            alignItems: 'flex-start',\n            p: 2,\n            borderBottom: '1px solid #eee',\n            '&:hover': {\n              backgroundColor: '#f5f5f5'\n            }\n          }}\n        >\n          <Box sx={{ flex: 1 }}>\n            <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 0.5 }}>\n              <Typography variant=\"body1\">\n                {registration.opd_number || `OPD-${registration.registration_id}`} â€” {registration.first_name} {registration.last_name}\n              </Typography>\n              <Box sx={{ display: 'flex', gap: 1 }}>\n                <Button\n                  variant=\"contained\"\n                  size=\"small\"\n                  color=\"error\"\n                  onClick={() => handleDelete(registration.registration_id)}\n                  sx={{ minWidth: '80px' }}\n                >\n                  Delete\n                </Button>\n                <Button\n                  variant=\"contained\"\n                  size=\"small\"\n                  color=\"primary\"\n                  onClick={() => handleViewDetails(registration.registration_id)}\n                  sx={{ minWidth: '80px' }}\n                >\n                  View\n                </Button>\n              </Box>\n            </Box>\n            <Typography variant=\"body2\" color=\"text.secondary\">\n              Guardian: {registration.guardian_name} | Age: {registration.age} | Mobile: {registration.mobile} | Aadhar: {registration.aadhar}\n            </Typography>\n          </Box>\n        </Box>\n      ))}\n      {registrations.length === 0 && (\n        <Typography variant=\"body1\" align=\"center\" sx={{ py: 3 }}>\n          No registrations found\n        </Typography>\n      )}\n    </Box>\n  );\n}\n\nexport default RegistrationList;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}